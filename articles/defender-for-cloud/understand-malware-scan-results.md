---
title: Understand malware scanning results
description: Learn how to understand and interpret the results from malware scanning in Microsoft Defender for Storage, including how to take appropriate actions.
ms.topic: how-to
ms.date: 09/07/2023
#customer intent: As a security administrator, I want to understand malware scan results so that I can take appropriate actions.
---

# Understand malware scanning results

When a blob is scanned for malware, the scan result can be assessed in several ways:

- **A blob index tag** - an index tag with the key *Malware scanning scan result* (index tags aren't supported in storage accounts with hierarchical namespaces enabled).
- **An Event Grid message** - allows you to automate responses to scan results. It requires more configuration. Learn more about [setting up Event Grid for malware scanning](advanced-configurations-for-malware-scanning.md#set-up-event-grid-for-malware-scanning).
- **A Log Analytics Workspace log entry** - by utilizing this method, you can store all scan results in a centralized log repository. This repository is designed for easy querying, making it a powerful tool for tracking and analyzing scan results. Learn more about [setting up logging for malware scanning](advanced-configurations-for-malware-scanning.md#set-up-logging-for-malware-scanning) and the [Event Grid](defender-for-storage-malware-scan.md#event-grid-event) message structure.
- **A security alert in Defender for Cloud (if malware was detected)** - you can read more about Microsoft [Defender for Cloud security alerts](alerts-overview.md#what-are-security-alerts).

Whether you're looking to [automate responses](defender-for-storage-configure-malware-scan.md#set-up-automation) to specific scan outcomes or to keep a detailed record of all scans, these options can be tailored to meet your needs.

Scan results fall into two categories: successful states and error states. Understanding these states is important for interpreting the results of malware scanning and taking appropriate action.

> [!NOTE]
> For storage accounts that exceed the [throughput capacity and blob size limits](defender-for-storage-malware-scan.md#throughput-capacity-and-blob-size-limit) for Defender for Storage malware scanning, some blobs will not be scanned and will not have a scan result.

## Success states

When a blob is successfully scanned, the scan result indicates either:

- **No threats found** - the scan found no malicious content.
- **Malicious** - malicious content was found in the uploaded blob.

    :::image type="content" source="media/understand-malware-scan-results/uploaded-blob.png" alt-text="Screenshot that shows an example of a blob scan result." lightbox="media/understand-malware-scan-results/uploaded-blob.png":::

## Error states

Malware scanning might fail to scan a blob. When this happens, the scan result indicates what the error was.  

|Error Message |Cause of Error| Guidance |Charge incurred|
|---|---|---|---|
|SAM259201: Scan failed - internal service error. |An unexpected internal system error occurred during the scan. |This is a transient error and subsequent upload of blobs that failed to be scanned with this error should succeed. | No |
|SAM259203: Not scanned - could not access the blob. |The blob couldn't be accessed due to permission restrictions. This can happen if someone accidentally removed the malware scanner’s permission to read blobs. Permissions can also be removed by an Azure Policy. |Look at the storage account’s Activity Log to determine who or what removed the scanner’s permissions. Re-enable Malware scanning. | No |
|SAM259206: Not scanned - blob exceeded the maximum allowed size of 50GB. |The blob size exceeded the size limit, preventing the scan. For more information, see the [malware scanning limitations](defender-for-storage-malware-scan.md#limitations) documentation. | N/A | No |
|SAM259207: Scan failed - scan exceeded time limitation.|The scan timed out before completion. This error might also occur if a preceding step, such as downloading the blob for scanning, takes too long. |This may be a transient error if the result of download timeout. | No |
|SAM259208: Not scanned - archive access tier is not supported.|Blobs in Azure's archive storage tier can't be scanned. For more information, see the [malware scanning limitations](defender-for-storage-malware-scan.md#limitations) documentation. | N/A | No |
|SAM259209: Not scanned - blobs encrypted with customer provided keys cannot be analyzed. |Client-side encrypted blobs can't be decrypted for scanning. For more information, see the [malware scanning limitations](defender-for-storage-malware-scan.md#limitations) documentation. | N/A | No |
|SAM259210: Scan failed - the requested blob is protected by password.|The blob is password-protected and can't be scanned. For more information, see the [malware scanning limitations](defender-for-storage-malware-scan.md#limitations) documentation. | N/A | Yes |
|SAM259211: Scan failed - maximum archive nesting depth exceeded.|The maximum archive nesting depth was exceeded. |Archive nesting is a known method for evading malware detection. Handle this blob with caution. | Yes |
|SAM259212: Scan failed - blob data is corrupt.|The blob is corrupted, and malware scanning was unable to scan it. | N/A | Yes |
|SAM259213: Not scanned - throttled by the service.|The scan request temporarily exceeded the service’s rate limit. This is a measure we take to manage server load and ensure optimal performance for all users. For more information, see the [malware scanning limitations](defender-for-storage-malware-scan.md) documentation.|To avoid this issue in the future, ensure your scan requests stay within the service’s rate limit. If your needs exceed the current rate limit, consider distributing your scan requests more evenly over time. |No|
|SAM259215: Not scanned - delayed by the service.|The scan has been delayed due to system load. It will be scanned when the load on the system subsides.|This is a transient state. Eventually the blob will be scanned.|No|
|SAM259220: Not scanned - immutability policy conflicted with another storage policy preventing blob access.|The scan could not be completed because the container has an immutability policy enabled and the storage account has Last Access Time (LAT) tracking enabled. These settings conflict and block read access to the blob.|Review your storage account configuration. To allow malware scanning, consider disabling LAT tracking or modifying the immutability policy to permit necessary access during scans.|No|

## Next steps

- Learn about [advanced configurations for malware scanning](advanced-configurations-for-malware-scanning.md).
