---
title: Vulnerability assessments for Defender for Container supported environments
description: Learn about vulnerability assessments for images and containers with Microsoft Defender Vulnerability Management.
author: ehorwitz-ms
ms.author: a-ehorwitz
ms.date: 02/23/2025
ms.topic: conceptual
---

# Vulnerability assessments for supported environments

In supported environment (Azure, AWS, or GCP), Defender for Containers can perform agentless vulnerability assessment on images in a supported container registry and on running containers. Relevant recommendations are generated for vulnerabilities detected in a container registry image or running container.

Vulnerability assessment of images in supported container registries is performed when **Registry access** is enabled for the Defender for Cloud Security Posture Management or Defender for Containers plans. Vulnerability assessment of running containers is performed when **Agentless scanning for machines** is enabled in the Defender for Cloud Security Posture Management or Defender for Containers plans, regardless of the source of the container image. Vulnerability assessment for running containers provides more value compared to only scanning images in supported container registries, as it also includes Kubernetes add-ons and 3rd party tools running in the cluster.

> [!NOTE]
> Containers created from images in unsupported registries are only scanned for vulnerability assessments if running within the AKS environment.

Vulnerability assessment of container images, powered by Microsoft Defender Vulnerability Management, has the following capabilities:  

- **Scanning OS packages** - Container vulnerability assessment has the ability to scan vulnerabilities in packages installed by the OS package manager in Linux and Windows OS. See the full list of the supported OS and their versions for each of the [Azure](support-matrix-defender-for-containers.md#registries-and-images-support-for-azure---vulnerability-assessment-powered-by-microsoft-defender-vulnerability-management), [AWS](support-matrix-defender-for-containers.md#registries-and-images-support-for-aws---vulnerability-assessment-powered-by-microsoft-defender-vulnerability-management), and [GCP](support-matrix-defender-for-containers.md#registries-and-images-support-for-gcp---vulnerability-assessment-powered-by-microsoft-defender-vulnerability-management) environments.
  
- **Language specific packages** – **Linux only** - Support for language specific packages and files, and their dependencies installed or copied without the OS package manager. See the complete list of supported languages for each of the [Azure](support-matrix-defender-for-containers.md#registries-and-images-support-for-azure---vulnerability-assessment-powered-by-microsoft-defender-vulnerability-management), [AWS](support-matrix-defender-for-containers.md#registries-and-images-support-for-aws---vulnerability-assessment-powered-by-microsoft-defender-vulnerability-management), and [GCP](support-matrix-defender-for-containers.md#registries-and-images-support-for-gcp---vulnerability-assessment-powered-by-microsoft-defender-vulnerability-management) environments.

- **Image scanning in Azure Private Link** - Azure container vulnerability assessment can scan images in container registries that are accessible via Azure Private Links. This capability requires access to trusted services and authentication with the registry. Learn how to [allow access by trusted services](/azure/container-registry/allow-access-trusted-services).

- **Exploitability information** - Each vulnerability report is searched through exploitability databases to assist our customers with determining actual risk associated with each reported vulnerability.

- **Reporting** - Container Vulnerability Assessment powered by Microsoft Defender Vulnerability Management provides vulnerability reports using the following recommendations:

- **Query vulnerability information via the Azure Resource Graph** - Ability to query vulnerability information via the [Azure Resource Graph](/azure/governance/resource-graph/overview#how-resource-graph-complements-azure-resource-manager). Learn how to [query recommendations via ARG](review-security-recommendations.md).

- **Query scan results via REST API** - Learn how to query scan results via the [REST API](subassessment-rest-api.md).

- **Support for exemptions** - Learn how to [create exemption rules for a management group, resource group, or subscription](disable-vulnerability-findings-containers.md).

- **Support for disabling vulnerabilities** - Learn how to [disable vulnerabilities on images](disable-vulnerability-findings-containers.md).

## Vulnerability assessment recommendations

The following new preview recommendations report on runtime container vulnerabilities and registry image vulnerabilities, and don't count toward secure score while in preview.  The scan engine for the new recommendations is the same as the current GA recommendations, and provides the same findings. The new recommendations are best suited for customers that use the new risk-based view for recommendations and have the Defender CSPM plan enabled.

# [Azure](#tab/azure-new)

| Recommendation | Description | Assessment Key |
|--|--|--|
| [[Preview] Container images in Azure registry should have vulnerability findings resolved](https://portal.azure.com/#blade/Microsoft_Azure_Security/RecommendationsBlade/assessmentKey/33422d8f-ab1e-42be-bc9a-38685bb567b9) | Defender for Cloud scans your registry images for known vulnerabilities (CVEs) and provides detailed findings for each scanned image. Scanning and remediating vulnerabilities for container images in the registry helps maintain a secure and reliable software supply chain, reduces the risk of security incidents, and ensures compliance with industry standards. | 33422d8f-ab1e-42be-bc9a-38685bb567b9 |
| [[Preview] Containers running in Azure should have vulnerability findings resolved](https://portal.azure.com/#blade/Microsoft_Azure_Security/RecommendationsBlade/assessmentKey/c5045ea3-afc6-4006-ab8f-86c8574dbf3d)  | Defender for Cloud creates an inventory of all container workloads currently running in your Kubernetes clusters and provides vulnerability reports for those workloads by matching the images being used and the vulnerability reports created for the registry images. Scanning and remediating vulnerabilities of container workloads is critical to ensure a robust and secure software supply chain, reduce the risk of security incidents, and ensures compliance with industry standards. | c5045ea3-afc6-4006-ab8f-86c8574dbf3d |

# [AWS](#tab/aws-new)

| Recommendation | Description | Assessment Key|
|--|--|--|
| [[Preview] Container images in AWS registry should have vulnerability findings resolved](https://portal.azure.com/#blade/Microsoft_Azure_Security/RecommendationsBlade/assessmentKey/2a139383-ec7e-462a-90ac-b1b60e87d576) | Defender for Cloud scans your registry images for known vulnerabilities (CVEs) and provides detailed findings for each scanned image. Scanning and remediating vulnerabilities for container images in the registry helps maintain a secure and reliable software supply chain, reduces the risk of security incidents, and ensures compliance with industry standards. | 2a139383-ec7e-462a-90ac-b1b60e87d576 |
| [[Preview] Containers running in AWS should have vulnerability findings resolved](https://portal.azure.com/#blade/Microsoft_Azure_Security/RecommendationsBlade/assessmentKey/8749bb43-cd24-4cf9-848c-2a50f632043c) | Defender for Cloud creates an inventory of all container workloads currently running in your Kubernetes clusters and provides vulnerability reports for those workloads by matching the images being used to and the vulnerability reports created for the registry images. Scanning and remediating vulnerabilities of container workloads is critical to ensure a robust and secure software supply chain, reduce the risk of security incidents, and ensures compliance with industry standards. | 8749bb43-cd24-4cf9-848c-2a50f632043c |

# [GCP](#tab/gcp-new)

| Recommendation | Description | Assessment Key|
|--|--|--|
| [[Preview] Container images in GCP registry should have vulnerability findings resolved](https://portal.azure.com/#blade/Microsoft_Azure_Security/RecommendationsBlade/assessmentKey/24e37609-dcf5-4a3b-b2b0-b7d76f2e4e04) | Defender for Cloud scans your registry images for known vulnerabilities (CVEs) and provides detailed findings for each scanned image. Scanning and remediating vulnerabilities for container images in the registry helps maintain a secure and reliable software supply chain, reduces the risk of security incidents, and ensures compliance with industry standards. | 24e37609-dcf5-4a3b-b2b0-b7d76f2e4e04 |
| [[Preview] Containers running in GCP should have vulnerability findings resolved](https://portal.azure.com/#blade/Microsoft_Azure_Security/RecommendationsBlade/assessmentKey/1b3abfa4-9e53-46f1-9627-51f2957f8bba) | Defender for Cloud creates an inventory of all container workloads currently running in your Kubernetes clusters and provides vulnerability reports for those workloads by matching the images being used and the vulnerability reports created for the registry images. Scanning and remediating vulnerabilities of container workloads is critical to ensure a robust and secure software supply chain, reduce the risk of security incidents, and ensures compliance with industry standards. | 1b3abfa4-9e53-46f1-9627-51f2957f8bba |

---

The following current GA recommendations report on vulnerabilities in containers within a Kubernetes cluster, and on container images within a container registry. These recommendations are best suited for customers that use the classic view for recommendations and do not have Defender CSPM plan enabled.

# [Azure](#tab/azure-old)

| Recommendation | Description | Assessment Key|
|--|--|--|
| [Azure registry container images should have vulnerabilities resolved (powered by Microsoft Defender Vulnerability Management)](https://ms.portal.azure.com/#view/Microsoft_Azure_Security_CloudNativeCompute/AzureContainerRegistryRecommendationDetailsBlade/assessmentKey/c0b7cfc6-3172-465a-b378-53c7ff2cc0d5) | Container image vulnerability assessment scans your registry for commonly known vulnerabilities (CVEs) and provides a detailed vulnerability report for each image. Resolving vulnerabilities can greatly improve your security posture, ensuring images are safe to use prior to deployment. | c0b7cfc6-3172-465a-b378-53c7ff2cc0d5 |
| [Azure running container images should have vulnerabilities resolved (powered by Microsoft Defender Vulnerability Management)](https://ms.portal.azure.com/#view/Microsoft_Azure_Security_CloudNativeCompute/ContainersRuntimeRecommendationDetailsBlade/assessmentKey/c609cf0f-71ab-41e9-a3c6-9a1f7fe1b8d5)  | Container image vulnerability assessment scans your registry for commonly known vulnerabilities (CVEs) and provides a detailed vulnerability report for each image. This recommendation provides visibility to vulnerable images currently running in your Kubernetes clusters. Remediating vulnerabilities in container images that are currently running is key to improving your security posture, significantly reducing the attack surface for your containerized workloads. | c609cf0f-71ab-41e9-a3c6-9a1f7fe1b8d5 |

# [AWS](#tab/aws-old)

| Recommendation | Description | Assessment Key|
|--|--|--|
| [AWS registry container images should have vulnerability findings resolved (powered by Microsoft Defender Vulnerability Management)](https://ms.portal.azure.com/#view/Microsoft_Azure_Security_CloudNativeCompute/AwsContainerRegistryRecommendationDetailsBlade/assessmentKey/c27441ae-775c-45be-8ffa-655de37362ce) | Scans your AWS registries container images for commonly known vulnerabilities (CVEs) and provides a detailed vulnerability report for each image. Resolving vulnerabilities can greatly improve your security posture, ensuring images are safe to use prior to deployment. | c27441ae-775c-45be-8ffa-655de37362ce |
| [AWS running container images should have vulnerability findings resolved (powered by Microsoft Defender Vulnerability Management)](https://ms.portal.azure.com/#view/Microsoft_Azure_Security_CloudNativeCompute/AwsContainersRuntimeRecommendationDetailsBlade/assessmentKey/682b2595-d045-4cff-b5aa-46624eb2dd8f) | Container image vulnerability assessment scans your registry for commonly known vulnerabilities (CVEs) and provides a detailed vulnerability report for each image. This recommendation provides visibility to vulnerable images currently running in your Elastic Kubernetes clusters. Remediating vulnerabilities in container images that are currently running is key to improving your security posture, significantly reducing the attack surface for your containerized workloads. | 682b2595-d045-4cff-b5aa-46624eb2dd8f |

# [GCP](#tab/gcp-old)

| Recommendation | Description | Assessment Key|
|--|--|--|
| [GCP registry container images should have vulnerability findings resolved (powered by Microsoft Defender Vulnerability Management) - Microsoft Azure](https://ms.portal.azure.com/#view/Microsoft_Azure_Security_CloudNativeCompute/GcpContainerRegistryRecommendationDetailsBlade/assessmentKey/5cc3a2c1-8397-456f-8792-fe9d0d4c9145) | Scans your GCP registries container images for commonly known vulnerabilities (CVEs) and provides a detailed vulnerability report for each image. Resolving vulnerabilities can greatly improve your security posture, ensuring images are safe to use prior to deployment. | c27441ae-775c-45be-8ffa-655de37362ce |
| [GCP running container images should have vulnerability findings resolved (powered by Microsoft Defender Vulnerability Management) - Microsoft Azure](https://ms.portal.azure.com/#view/Microsoft_Azure_Security_CloudNativeCompute/GcpContainersRuntimeRecommendationDetailsBlade/assessmentKey/e538731a-80c8-4317-a119-13075e002516) | Container image vulnerability assessment scans your registry for commonly known vulnerabilities (CVEs) and provides a detailed vulnerability report for each image. This recommendation provides visibility to vulnerable images currently running in your Google Kubernetes clusters. Remediating vulnerabilities in container images that are currently running is key to improving your security posture, significantly reducing the attack surface for your containerized workloads. | 5cc3a2c1-8397-456f-8792-fe9d0d4c9145 |

---

## How Vulnerability Assessment for Images and Containers Works

### Scanning images in Defender for Containers supported registries

> [!NOTE]
> The **Registry access** extension must be enabled for vulnerability assessment of images in container registries.

The scan of an image in a container registry creates an inventory of the image and its vulnerability recommendations. The [supported container image registries](support-matrix-defender-for-containers.md) are: Azure Container Registry (ACR), Amazon AWS Elastic Container Registry (ECR), Google Artifact Registry (GAR), Google Container Registry (GCR), and [configured external registries](support-matrix-defender-for-containers.md#external-container-registries). An image is scanned when:

- A new image is pushed or imported to the container registry. The image is scanned within a few hours.
- **Continuous re-scan triggering** – continuous re-scan is required to ensure images that have been previously scanned for vulnerabilities are re-scanned to update their vulnerability reports in case a new vulnerability is published.
  - **Re-scan** is performed once a day for:  
    - Images pushed in the last 90 days.<sup>[*](#prvpush)</sup>
    - Images pulled in the last 30 days.
    - Images currently running on the Kubernetes clusters monitored by Defender for Cloud (either via [Agentless discovery for Kubernetes](defender-for-containers-enable.md#enablement-method-per-capability) or the [Defender sensor](defender-for-containers-enable.md#enablement-method-per-capability)).

    <sup><a name="prvpush"></a>*</sup> The new [preview recommendation](recommendations-reference-container.md#preview-container-images-in-azure-registry-should-have-vulnerability-findings-resolved) is generated for images pushed in the last 30 days.

#### Frequency of image scans

An image is scanned within 24 hours when it is pulled from the container registry. 

> [!NOTE]
> In some rare cases, a new image in the registry might take up to 24 hours before scanning.

In addition, the following images are scanned every 24 hours to update their vulnerability recommendations, in the event a new vulnerability is published.

- An image is pushed or imported to the container registry in the last 90 days.

- An image is pulled from the container registry in the last 30 days.

> [!NOTE]
> For [Defender for Container Registries (deprecated)](defender-for-container-registries-introduction.md), images are scanned once on push, on pull, and rescanned only once a week.

### Scanning containers running in the cluster workload

Containers running in the cluster workload are scanned for vulnerabilities every 24 hours. The scan is agnostic to the running container image's source registry and includes Kubernetes add-ons and third party tools. The relevant recommendations are generated for each vulnerable container.

> [!NOTE]
> Agentless scanning for running containers is performed when both the following extensions are enabled:
>     - **Agentless machine scanning**
>     - **K8S API access** or **Defender sensor**

> [!NOTE]
> Containers created using images from unsupported container registries will only be scanned if running within the AKS environment.

Recommendations for a running container using an image from a supported container registry, are generated from the container registry image scan, even if a customer doesn't enable **Agentless machine scanning**.

> [!NOTE]
> The container runtime layer can't be scanned for vulnerabilities. In addition, the following containers can't be scanned for vulnerabilities:
>
> - Containers in nodes using AKS Ephemeral OS disks
> - Auto-scale configured AKS clusters may provide only partial results.
> - Windows OS containers

#### Scanning process for running containers

- All newly discovered images are pulled, and an inventory is created for each image. Image inventory is kept to avoid further image pulls, unless required by new scanner capabilities.​

- Using the inventory, vulnerability reports are generated for new images, and updated for images previously scanned, which were either pushed in the last 90 days<sup>[*](#prvpush)</sup> to a registry, or are currently running. To determine if an image is currently running, Defender for Cloud uses both  [Agentless discovery for Kubernetes](defender-for-containers-enable.md#enablement-method-per-capability) and [inventory collected via the Defender sensor running on AKS nodes](defender-for-containers-enable.md#enablement-method-per-capability)

- Vulnerability reports for registry container images are provided as a [recommendation](https://ms.portal.azure.com/#view/Microsoft_Azure_Security_CloudNativeCompute/AzureContainerRegistryRecommendationDetailsBlade/assessmentKey/33422d8f-ab1e-42be-bc9a-38685bb567b9).

- For customers using either [Agentless discovery for Kubernetes](defender-for-containers-enable.md#enablement-method-per-capability) or [inventory collected via the Defender sensor running on AKS nodes](defender-for-containers-enable.md#enablement-method-per-capability), Defender for Cloud also creates a [recommendation](https://portal.azure.com/#view/Microsoft_Azure_Security_CloudNativeCompute/ContainersRuntimeRecommendationDetailsBlade/assessmentKey/e9acaf48-d2cf-45a3-a6e7-3caa2ef769e0) for remediating vulnerable container images running on an AKS cluster.

- For customers using only [Agentless discovery for Kubernetes](defender-for-containers-enable.md#enablement-method-per-capability), the refresh time for inventory in this recommendation is once every seven hours. Clusters that are also running the [Defender sensor](defender-for-containers-enable.md#enablement-method-per-capability) benefit from a two hour inventory refresh rate. Image scan results are updated based on registry scans in either case, and are therefore only refreshed every 24 hours.

## If I remove an image from my registry, how long before vulnerabilities reports on that image would be removed?

Azure Container Registries notifies Defender for Cloud when images are deleted, and removes the vulnerability assessment for deleted images within one hour. In some rare cases, Defender for Cloud might not be notified on the deletion, and deletion of associated vulnerabilities in such cases might take up to three days.

## Next steps

- Learn more about the Defender for Cloud [Defender plans](defender-for-cloud-introduction.md#protect-cloud-workloads).
- Check out [common questions](faq-defender-for-containers.yml) about Defender for Containers.
