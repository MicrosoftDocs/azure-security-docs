---
title: Classic configuration vulnerability findings
description: Learn how to remediate software vulnerabilities and disable findings with the classic configuration.
author: dcurwin
ms.author: dacurwin
ms.date: 12/10/2024
ms.service: defender-for-cloud
ms.topic: how-to
---

# Classic configuration vulnerability findings

Microsoft Defender for Cloud provides [vulnerability assessments](sql-azure-vulnerability-assessment-overview.md) for your Azure SQL databases. Vulnerability assessments scan your databases for software vulnerabilities and provide a list of findings. You can use the findings to remediate software vulnerabilities and disable them.

## Prerequisites

Ensure you know whether you're using the [express or classic configurations](sql-azure-vulnerability-assessment-overview.md#what-are-the-express-and-classic-configurations) before continuing.

To determine your configuration:

1. In the [Azure portal](https://portal.azure.com), open the specific resource in Azure SQL Database, SQL Managed Instance, or Azure Synapse.

1. Under the **Security**, select **Defender for Cloud**.

1. In **Enablement Status**, select **Configure** to open the Microsoft Defender for SQL settings, for the entire server, or managed instance.

If the vulnerability settings show the option to configure a storage account, you're using the classic configuration. Otherwise, you're using the express configuration.

## View scan history

Select **Scan History** in the vulnerability assessment pane to view the history of all scans previously run on this database.

### Disable specific findings from Microsoft Defender for Cloud (preview)

If you need to ignore a finding rather than remediate it, you can disable it. Disabled findings don't affect your secure score or generate noise.

When a finding matches your disable rules criteria, it doesn't appear in the findings list.
Typical scenarios might include:

- Disable findings with medium or lower severity.
- Disable findings that are nonpatchable.
- Disable findings from benchmarks that aren't of interest for a defined scope.

> [!IMPORTANT]
>
> - To disable specific findings, you need permission to edit a policy in Azure Policy. Learn more in [Azure RBAC permissions in Azure Policy](/azure/governance/policy/overview#azure-rbac-permissions-in-azure-policy).
> - Disabled findings are still included in the weekly SQL vulnerability assessment email report.
> - Disabled rules appear in the 'Not applicable' section of the scan results.

## Disable a rule

Defender for Cloud provides a way to disable specific findings.

1. Sign in to the [Azure portal](https://portal.azure.com).

1. Navigate to **Microsoft Defender for Cloud** > **Recommendations**.

1. Search for and select **Vulnerability assessment findings on your SQL servers on machines should be remediated**.

1. Select **Disable rule**.

1. Select the scope.

1. Define your criteria. You can use the following criteria:

    - Finding ID
    - Severity
    - Benchmarks

    :::image type="content" source="media/defender-for-sql-Azure-vulnerability-assessment/disable-rule-vulnerability-findings-sql.png" alt-text="Screenshot of create a disable rule for VA findings on SQL servers on machines.":::

1. Select **Apply rule**. 

Changes can take up to 24 hours to take effect.

## View, override, or delete a rule

1. Select **Disable rule**.

1. From the scope list, subscriptions with active rules show as **Rule applied**.

   :::image type="content" source="media/defender-for-sql-Azure-vulnerability-assessment/modify-rule.png" alt-text="Screenshot of modify or delete an existing rule.":::

1. To view or delete the rule, select the ellipsis menu ("...").

## Manage vulnerability assessments programmatically

### Azure PowerShell

> [!NOTE]
> TThis article uses the Azure Az PowerShell module, the recommended PowerShell module for interacting with Azure. To start with the Az PowerShell module, see [Install Azure PowerShell](/powershell/azure/install-azure-powershell). To learn how to migrate to the Az PowerShell module, see [Migrate Azure PowerShell from AzureRM to Az](/powershell/azure/migrate-from-azurerm-to-az).

> [!IMPORTANT]
> The PowerShell Azure Resource Manager module is still supported, but all future development is for the Az.Sql module. For these cmdlets, see [AzureRM.Sql](/powershell/module/AzureRM.Sql/). The arguments for the commands in the Az module and the AzureRm modules are substantially identical.

You can use Azure PowerShell cmdlets to manage your vulnerability assessments programmatically. The supported cmdlets are:

| Cmdlet name as a link | Description |
|:-|:-|
| [Clear-AzSqlDatabaseVulnerabilityAssessmentRuleBaseline](/powershell/module/az.sql/Clear-azSqlDatabaseVulnerabilityAssessmentRuleBaseline) | Clears the vulnerability assessment rule baseline.<br/>Sets the baseline before using this cmdlet to clear it. |
| [Clear-AzSqlDatabaseVulnerabilityAssessmentSetting](/powershell/module/az.sql/Clear-azSqlDatabaseVulnerabilityAssessmentSetting) | Clears the vulnerability assessment settings of a database. |
| [Clear-AzSqlInstanceDatabaseVulnerabilityAssessmentRuleBaseline](/powershell/module/az.sql/Clear-AzSqlInstanceDatabaseVulnerabilityAssessmentRuleBaseline) | Clears the vulnerability assessment rule baseline of a managed database.<br/>First, set the baseline before you use this cmdlet to clear it. |
| [Clear-AzSqlInstanceDatabaseVulnerabilityAssessmentSetting](/powershell/module/az.sql/Clear-AzSqlInstanceDatabaseVulnerabilityAssessmentSetting) | Clears the vulnerability assessment settings of a managed database. |
| [Clear-AzSqlInstanceVulnerabilityAssessmentSetting](/powershell/module/az.sql/Clear-AzSqlInstanceVulnerabilityAssessmentSetting) | Clears the vulnerability assessment settings of a managed instance. |
| [Convert-AzSqlDatabaseVulnerabilityAssessmentScan](/powershell/module/az.sql/Convert-azSqlDatabaseVulnerabilityAssessmentScan) | Converts vulnerability assessment scan results of a database to an Excel file (export). |
| [Convert-AzSqlInstanceDatabaseVulnerabilityAssessmentScan](/powershell/module/az.sql/Convert-AzSqlInstanceDatabaseVulnerabilityAssessmentScan) | Converts vulnerability assessment scan results of a managed database to an Excel file (export). |
| [Get-AzSqlDatabaseVulnerabilityAssessmentRuleBaseline](/powershell/module/az.sql/Get-azSqlDatabaseVulnerabilityAssessmentRuleBaseline) | Gets the vulnerability assessment rule baseline of a database for a given rule. |
| [Get-AzSqlInstanceDatabaseVulnerabilityAssessmentRuleBaseline](/powershell/module/az.sql/Get-AzSqlInstanceDatabaseVulnerabilityAssessmentRuleBaseline) | Gets the vulnerability assessment rule baseline of a managed database for a given rule. |
| [Get-AzSqlDatabaseVulnerabilityAssessmentScanRecord](/powershell/module/az.sql/Get-azSqlDatabaseVulnerabilityAssessmentScanRecord) | Gets all vulnerability assessment scan records associated with a given database. |
| [Get-AzSqlInstanceDatabaseVulnerabilityAssessmentScanRecord](/powershell/module/az.sql/Get-AzSqlInstanceDatabaseVulnerabilityAssessmentScanRecord) | Gets all vulnerability assessment scan records associated with a given managed database. |
| [Get-AzSqlDatabaseVulnerabilityAssessmentSetting](/powershell/module/az.sql/Get-azSqlDatabaseVulnerabilityAssessmentSetting) | Returns the vulnerability assessment settings of a database. |
| [Get-AzSqlInstanceDatabaseVulnerabilityAssessmentSetting](/powershell/module/az.sql/Get-AzSqlInstanceDatabaseVulnerabilityAssessmentSetting) | Returns the vulnerability assessment settings of a managed database. |
| [Set-AzSqlDatabaseVulnerabilityAssessmentRuleBaseline](/powershell/module/az.sql/Set-azSqlDatabaseVulnerabilityAssessmentRuleBaseline) | Sets the vulnerability assessment rule baseline. |
| [Set-AzSqlInstanceDatabaseVulnerabilityAssessmentRuleBaseline](/powershell/module/az.sql/Set-AzSqlInstanceDatabaseVulnerabilityAssessmentRuleBaseline) | Sets the vulnerability assessment rule baseline for a managed database. |
| [Start-AzSqlDatabaseVulnerabilityAssessmentScan](/powershell/module/az.sql/Start-azSqlDatabaseVulnerabilityAssessmentScan) | Triggers the start of a vulnerability assessment scan on a database. |
| [Start-AzSqlInstanceDatabaseVulnerabilityAssessmentScan](/powershell/module/az.sql/Start-AzSqlInstanceDatabaseVulnerabilityAssessmentScan) | Triggers the start of a vulnerability assessment scan on a managed database. |
| [Update-AzSqlDatabaseVulnerabilityAssessmentSetting](/powershell/module/az.sql/Update-azSqlDatabaseVulnerabilityAssessmentSetting) | Updates the vulnerability assessment settings of a database. |
| [Update-AzSqlInstanceDatabaseVulnerabilityAssessmentSetting](/powershell/module/az.sql/Update-AzSqlInstanceDatabaseVulnerabilityAssessmentSetting) | Updates the vulnerability assessment settings of a managed database. |
| [Update-AzSqlInstanceVulnerabilityAssessmentSetting](/powershell/module/az.sql/Update-AzSqlInstanceVulnerabilityAssessmentSetting) | Updates the vulnerability assessment settings of a managed instance. |

For a script example, see [Azure SQL vulnerability assessment PowerShell support](/archive/blogs/sqlsecurity/azure-sql-vulnerability-assessment-now-with-powershell-support).

### Azure CLI

> [!IMPORTANT]
> The following Azure CLI commands are for SQL databases hosted on VMs or on-premises machines. For vulnerability assessments regarding Azure SQL Databases, refer to the Azure portal or PowerShell section.

You can use Azure CLI commands to manage your vulnerability assessments programmatically. The supported commands are:

| Command name as a link | Description |
|:-|:-|
| [`az security va sql baseline delete`](/cli/azure/security/va/sql/baseline#az-security-va-sql-baseline-delete) | Delete SQL vulnerability assessment rule baseline. |
| [`az security va sql baseline list`](/cli/azure/security/va/sql/baseline#az-security-va-sql-baseline-list) | View SQL vulnerability assessment baseline for all rules. |
| [`az security va sql baseline set`](/cli/azure/security/va/sql/baseline#az-security-va-sql-baseline-set) | Sets SQL vulnerability assessment baseline. Replaces the current baseline. |
| [`az security va sql baseline show`](/cli/azure/security/va/sql/baseline#az-security-va-sql-baseline-show) | View SQL vulnerability assessment rule baseline. |
| [`az security va sql baseline update`](/cli/azure/security/va/sql/baseline#az-security-va-sql-baseline-update) | Update SQL vulnerability assessment rule baseline. Replaces the current rule baseline. |
| [`az security va sql results list`](/cli/azure/security/va/sql/results#az-security-va-sql-results-list) | View all SQL vulnerability assessment scan results. |
| [`az security va sql results show`](/cli/azure/security/va/sql/results#az-security-va-sql-results-show) | View SQL vulnerability assessment scan results. |
| [`az security va sql scans list`](/cli/azure/security/va/sql/scans#az-security-va-sql-scans-list) | List all SQL vulnerability assessment scan summaries. |
| [`az security va sql scans show`](/cli/azure/security/va/sql/scans#az-security-va-sql-scans-show) | View SQL vulnerability assessment scan summaries. |

### Resource Manager templates

To configure vulnerability assessment baselines using Azure Resource Manager templates, use the `Microsoft.Sql/servers/databases/vulnerabilityAssessments/rules/baselines` type.

Ensure you have enabled `vulnerabilityAssessments` before you add baselines.

Here's an example for defining Baseline Rule VA2065 to `master` database and VA1143 to `user` database as resources in a Resource Manager template:

```json
   "resources": [
      {
         "type": "Microsoft.Sql/servers/databases/vulnerabilityAapiVersion": "2018-06-01",
         "name": "[concat(parameters('server_name'),'/', parameters('database_name') , '/default/VA2065/master')]",
         "properties": {
            "baselineResults": [
               {
                  "result": [
                     "FirewallRuleName3",
                     "StartIpAddress",
                     "EndIpAddress"
                  ]
               },
               {
                  "result": [
                     "FirewallRuleName4",
                     "62.92.15.68",
                     "62.92.15.68"
                  ]
               }
            ]
         },
         "type": "Microsoft.Sql/servers/databases/vulnerabilityAapiVersion": "2018-06-01",
         "name": "[concat(parameters('server_name'),'/', parameters('database_name'), '/default/VA2130/Default')]",
         "dependsOn": [
            "[resourceId('Microsoft.Sql/servers/vulnerabilityAssessments', parameters('server_name'), 'Default')]"
         ],
         "properties": {
            "baselineResults": [
               {
                  "result": [
                     "dbo"
                  ]
               }
            ]
         }
      }
   ]
```

For `master` database and `user` database, the resource names are defined differently:

- Master database - "name": "[concat(parameters('server_name'),'/', parameters('database_name'), '/default/VA2065/<b>master</b>')]",
- User database - "name": "[concat(parameters('server_name'),'/', parameters('database_name'), '/default/VA2065/<b>default</b>')]",

To handle Boolean types as true/false, set the baseline result with binary input like "1"/"0".

```json
   {
      "type": "Microsoft.Sql/servers/databases/vulnerabilityapiVersion": "2018-06-01",
      "name": "[concat(parameters('server_name'),'/', parameters('database_name'), '/default/VA1143/Default')]",

      "dependsOn": [
         "[resourceId('Microsoft.Sql/servers/vulnerabilityAssessments', parameters('server_name'), 'Default')]"
      ],

      "properties": {
         "baselineResults": [
            {
               "result": [
                  "1"
               ]
            }
         ]
      }

   }
```

## Related content

- Learn more about [Microsoft Defender for Azure SQL](defender-for-sql-introduction.md).
- Learn more about [data discovery and classification](/azure/azure-sql/database/data-discovery-and-classification-overview).
- Learn more about [storing vulnerability assessment scan results in a storage account accessible behind firewalls and VNets](/azure/azure-sql/database/sql-database-vulnerability-assessment-storage).
- Check out [common questions](faq-defender-for-databases.yml) about Azure SQL databases.
