---
title: Agentless malware scanning for machines in Microsoft Defender for Cloud
description: Learn how agentless malware scanning in Defender for Cloud can protect your virtual machines from malware.
author: dcurwin
ms.author: dacurwin
ms.service: defender-for-cloud
ms.topic: conceptual
ms.date: 01/16/2024
ms.custom: template-concept
---

# Agentless malware scanning for machines

Microsoft Defender for Cloud provides agentless malware scanning for virtual machines as part of its [agentless machine scanning features](concept-agentless-data-collection.md) that improve security posture on Azure VMs, and on AWS and GCP machines connected to Defender for Cloud. Agentless scanning doesn't need any installed agents or network connectivity, and doesn't effect machine performance.

Agentless malware scanning provides:

- Up-to-date and comprehensive malware detection capabilities that utilize the [Microsoft Defender Antivirus](/microsoft-365/security/defender-endpoint/microsoft-defender-antivirus-windows) engine and [cloud protection](/microsoft-365/security/defender-endpoint/cloud-protection-microsoft-defender-antivirus) signature feed that Microsoft's intelligence feeds support.

- Quick and full scans that use heuristic and signature-based threat detection.

- Security alerts that are generated when malware is detected. These alerts provide extra details and context for investigations, and are sent to both the Defender for Cloud Alerts page and Defender XDR.

Agentless malware scanning for machines in available in Defender for Servers Plan 2 with agentless scanning enabled. Scanning for malware is supported for Azure VMs, and AWS/GCP machines connected to Defender for Cloud. 

## Agentless detection benefits

Agentless malware scanning offers the following benefits to both protected and unprotected machines:

- **Improved coverage** - If a machine doesn't have an antivirus solution enabled, the agentless detector scans that machine to detect malicious activity.

- **Detect potential threats** - The agentless scanner scans all files and folders including any files or folders that are excluded from the agent-based antivirus scans, without having an effect on the performance of the machine.

You can learn more about [agentless machine scanning](concept-agentless-data-collection.md) and how to [enable agentless scanning for VMs](enable-agentless-scanning-vms.md).



## Malware security alerts

When a malicious file is detected, Defender for Cloud generates a [security alert](alerts-overview.md#what-are-security-alerts).

- Security alerts only appear in the portal when threats are detected on your environment. If you don't have any alerts it might be because there are no threats on your environment.
- You can [run a test](enable-agentless-scanning-vms.md#test-the-agentless-malware-scanners-deployment) to check that agentless malware scanning is working as expected.
- Security alerts contain details and context on the file, the malware type, and recommended investigation and remediation steps.
- You can [configure automations](workflow-automation.yml) based on these alerts.
- You can also [export security alerts](alerts-overview.md#exporting-alerts) to a SIEM such as [Microsoft Sentinel connector](../sentinel/connect-defender-for-cloud.md), or another SIEM of your choice.

Learn about [responding to security alerts](../event-grid/custom-event-quickstart-portal.md#subscribe-to-custom-topic).


### Handling possible false positives

If you believe a file is being incorrectly detected as malware (false positive), you can submit it for analysis through the [sample submission portal](/microsoft-365/security/intelligence/submission-guide). 

- The submitted file is analyzed by Defender's security analysts.
- If the analysis report indicates that the file is clean, then the file will no longer trigger new alerts from now on.

Defender for Cloud allows you to [suppress false positive alerts](alerts-suppression-rules.md). Make sure to limit the suppression rule by using the malware name or file hash.

## Next step

Learn how to [enable agentless scanning for VMs](enable-agentless-scanning-vms.md).
